package view;

import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.time.format.DateTimeParseException;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;

import model.Corrida;
import util.DateValidator;

public class CreateRace extends JFrame {
	
	private static final long serialVersionUID = 1L;

	public CreateRace() {
		this.setTitle("Criar Corrida");
		this.setSize(600, 400);
		this.setVisible(true);
		this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		this.setResizable(false);

		Container c = this.getContentPane();
		c.setLayout(new BorderLayout());

		JPanel panel = new JPanel();
		panel.setLayout(new GridLayout(6, 2, 2, 2));
		c.add(panel);

		JLabel name = new JLabel("Informe o nome da corrida:");
		name.setToolTipText("Nome da corrida");
		JTextField nameInput = new JTextField(30);
		nameInput.setSize(100,100);
		panel.add(name);
		panel.add(nameInput);

		JLabel city = new JLabel("Informe a cidade que ocorrerá:");
		city.setToolTipText("Cidade em que ocorrerá a corrida");
		JTextField cityInput = new JTextField(30);
		panel.add(city);
		panel.add(cityInput);

		JLabel startLocal = new JLabel("Informe o local de início da corrida:");
		startLocal.setToolTipText("Local de início da corrida");
		JTextField startLocalInput = new JTextField(30);
		panel.add(startLocal);
		panel.add(startLocalInput);

		JLabel percurso = new JLabel("Informe o percurso total da corrida:");
		percurso.setToolTipText("percurso da corrida");
		JTextField percursoInput = new JTextField(30);
		percursoInput.setText("Ex:12KM");
		panel.add(percurso);
		panel.add(percursoInput);
		
		JLabel data = new JLabel("Informe a data da corrida:");
		data.setToolTipText("Data da corrida");
		JTextField dataInput = new JTextField(30);
		panel.add(data);
		panel.add(dataInput);

		JButton Btncriar = new JButton("Criar Corrida");
		panel.add(Btncriar);

		Btncriar.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				
				String name = nameInput.getText().trim();
				String city = cityInput.getText().trim();
				String startLocal = startLocalInput.getText().trim();
				String percurso = percursoInput.getText().trim();
				String data = dataInput.getText().trim();
				
				if(name.isEmpty() || city.isEmpty() || startLocal.isEmpty() || percurso.isEmpty() || data.isEmpty()) {
					JOptionPane.showMessageDialog(null, "Um ou mais campos estão vazios");
					return;
				}
				
				if(DateValidator.validateDateToRace(data, Corrida.getFormato())) {
					JOptionPane.showMessageDialog(null, "A data não pode ja ter passado");
				}
				
				try {
					Corrida corrida = new Corrida(name,
							city,
							startLocal,
							percurso,
							data);
					
					new CadastrarCorredor(corrida);
					
				}catch(DateTimeParseException ex) {
					JOptionPane.showMessageDialog(null, "A data tem estar no formato dd/MM/yyyy HH:mm e tem que ser uma data válida");
				}
			}
		});
	}
}
